<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <title>色変更 ver2</title>
  <link rel="stylesheet" href="./css/style2.css">
</head>

<body>

  <div class="color-box"></div>

  <ul class="button-list">
    <li>
      <button class="button" data-color="blue">青</button>
    </li>
    <li>
      <button class="button" data-color="yellow">黄</button>
    </li>
    <li>
      <button class="button" data-color="green">緑</button>
    </li>
    <li>
      <button class="button" data-color="red">赤</button>
    </li>
  </ul>

  <p class="color-count">色を変えた回数は 0回 です</p>

  <script>

    class ColorChanger {
      constructor() {
        /* エレメント取得 */
        this.color_box = document.querySelector('.color-box');
        this.button = document.querySelectorAll('.button');
        this.text = document.querySelector('.color-count');


        this.color = null;
        this.count = 0;


        this.bind();
      }

      bind() {
        [].forEach.call(this.button, button => {
          button.addEventListener('click', (e) => {
            if (this.color_box.classList.contains(e.currentTarget.dataset.color)) return;
            this.resetClass();
            this.color = e.currentTarget.dataset.color;

            this.addCount();
            this.changeColor(e.currentTarget.dataset.color);
          });
        });
      }

      /* クラス名を消去します */
      resetClass() {
        this.color_box.classList.remove(this.color);
      }

      /* 背景色を変えます */
      changeColor(colorName) {
        this.color_box.classList.add(colorName);
      }

      /* 背景色を変えた回数をカウントします */
      addCount() {
        this.count++;
        this.text.textContent = `色を変えた回数は ${this.count}回 です`;
      }
    }

    const changeColor = new ColorChanger();

  </script>
</body>

</html>
